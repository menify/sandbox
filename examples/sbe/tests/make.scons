import os.path

Import('env')

env.Tool('aql_tool_flexelint')
env.Tool('aql_tool_unittest')

options = env.aqlOptions()

options.cpppath += '#/..'

src_files = env.aqlFindFiles( '.', '*.cpp' )

for s in src_files:
    
    test_name = os.path.splitext( os.path.split(s)[1] )[0]
    
    test_app = env.Program( test_name, s )
    
    env.Alias( test_name, test_app )
    env.Default( test_app )
    
    test = env.UnitTest( test_app, UT_VERBOSE = 1 )
    env.AlwaysBuild( test )
    
    env.Alias( 'run_' + test_name, test )
    env.Alias( ['run', 'test'], test )

